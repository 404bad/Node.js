<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/Head') %>
    <title>Home Page</title>
  </head>

  <body>
    <%- include('partials/nav') %>

    <div class="container mt-4">
      <div class="creator d-flex gap-2 align-items-center my-5">
        <div class="img">
          <img src="<%= blog.createdBy.profileImage %>" alt="" width="40px" />
        </div>
        <h4><%= blog.createdBy.fullName %></h4>
      </div>
      <h1><%= blog.title %></h1>
      <img src="<%= blog.coverImgUrl %>" alt="" width="100%" />
      <pre
        style="white-space: pre-wrap; word-break: break-word; margin-top: 30px"
      >
                <%= blog.content %>
            </pre
      >
    </div>
    <div class="container mt-5">
      <div class="row">
        <div class="col-md-5">
          <h3>Leave Comments</h3>
          <form
            action="/blogs/comment/<%= blog._id %>"
            method="POST"
            class="mb-4"
          >
            <div class="mb-3">
              <label for="comment" class="form-label">Add a comment:</label>
              <textarea
                class="form-control"
                id="comment"
                name="content"
                rows="3"
                required
              ></textarea>
            </div>
            <% if(!locals.user){ %>
            <a href="/user/signin" class="btn btn-primary"
              >Please login to add comment</a
            >
            <% } else { %>
            <button type="submit" class="btn btn-primary">Submit</button>
            <% } %>
          </form>
        </div>
        <div class="col-md-1"></div>
        <div class="col-md-6">
          <h3>
            Recent Comments (<%= blog.comments ? blog.comments.length : 0 %> )
          </h3>
          <div class="comments-section">
            <% if (blog.comments && blog.comments.length > 0) { %> <%
            blog.comments.forEach(function(comment) { %>
            <div class="creator d-flex gap-2 align-items-center mb-2">
              <div class="img">
                <!-- //need commento image and name -->
                <img
                  src="<%= comment.createdBy.profileImage %>"
                  alt=""
                  width="40px"
                />
              </div>
              <div>
                <h5><%= comment.createdBy.fullName %></h5>
              </div>
            </div>
            <pre><%= comment.content %></pre>
            <% }); %> <% } else { %>
            <p>No comments yet. Be the first to comment!</p>
            <% } %>
          </div>
        </div>
      </div>
    </div>

    <%- include('partials/scripts') %> <%- include('partials/footer') %>
  </body>
</html>
